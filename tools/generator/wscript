#!/usr/bin/env python3

from waflib import Utils


def build(bld):
    bld(
        features='subst',
        source='entrypoint.sh.in',
        target='stechec2-generator',
        chmod=Utils.O755,
    )

    bld.install_files('${PREFIX}/bin', ['stechec2-generator'],
                      chmod=Utils.O755)

    # TODO: This is probably the worst possible way to install a Python
    # package. If anyone knows how to just... use a setup.py or something,
    # please tell me how.

    bld.install_files('${PREFIX}/lib/stechec2/generator', [
        '__init__.py',
        '__main__.py',
        'rules.py',
        'texdoc.py',
    ])

    bld.install_files('${PREFIX}/lib/stechec2/generator/templates/rules', [
        'templates/rules/action_template.cc.jinja2',
        'templates/rules/action_template.hh.jinja2',
        'templates/rules/actions.hh.jinja2',
        'templates/rules/api.cc.jinja2',
        'templates/rules/api.hh.jinja2',
        'templates/rules/constant.hh.jinja2',
        'templates/rules/entry.cc.jinja2',
        'templates/rules/game_state.cc.jinja2',
        'templates/rules/game_state.hh.jinja2',
        'templates/rules/interface.cc.jinja2',
        'templates/rules/rules.cc.jinja2',
        'templates/rules/rules.hh.jinja2',
    ])

    bld.install_files('${PREFIX}/lib/stechec2/generator/templates/texdoc', [
        'templates/texdoc/apidoc.tex.jinja2',
        'templates/texdoc/useapi.tex.jinja2',
    ])
